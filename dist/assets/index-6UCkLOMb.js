(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const n of o)if(n.type==="childList")for(const r of n.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&s(r)}).observe(document,{childList:!0,subtree:!0});function e(o){const n={};return o.integrity&&(n.integrity=o.integrity),o.referrerPolicy&&(n.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?n.credentials="include":o.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(o){if(o.ep)return;o.ep=!0;const n=e(o);fetch(o.href,n)}})();class us{constructor(t,e,s){this.c=e,this.canvas=s,this.position={x:100,y:100},this.velocity={x:0,y:1},this.image=t,this.isOnGround=!1,this.totalFrames=8,this.frameIndex=0,this.frameRate=120,this.lastFrameTime=0,this.frameWidth=t.width/this.totalFrames,this.frameHeight=t.height,this.width=this.frameWidth,this.height=this.frameHeight,this.facingLeft=!1,this.invincible=!1,this.flicker=!1,this.gravity=.5,this.offsetLeft=50,this.offsetRight=50,this.offsetTop=0,this.offsetBottom=3}draw(){if(this.flicker)return;const t=this.c;if(this.c.save(),this.isOnGround){const e=this.position.x+this.width/2,s=this.position.y+this.height*.95,o=this.width*.7,n=this.height*.05,r=t.createRadialGradient(e,s,0,e,s,o/2);r.addColorStop(0,"rgba(13, 56, 18, 0.64)"),r.addColorStop(1,"rgba(0, 0, 0, 0)"),t.filter="blur(8px)",t.fillStyle=r,t.beginPath(),t.ellipse(e,s,o/2,n/2,0,0,2*Math.PI),t.fill(),t.filter="none"}this.facingLeft?(this.c.scale(-1,1),this.c.drawImage(this.image,this.frameIndex*this.frameWidth,0,this.frameWidth,this.frameHeight,-this.position.x-this.width,this.position.y,this.width,this.height)):this.c.drawImage(this.image,this.frameIndex*this.frameWidth,0,this.frameWidth,this.frameHeight,this.position.x,this.position.y,this.width,this.height),this.c.restore()}getCollisionBox(){return{left:this.position.x+this.offsetLeft,right:this.position.x+this.width-this.offsetRight,top:this.position.y+this.offsetTop,bottom:this.position.y+this.height-this.offsetBottom}}updateAnimation(t){t-this.lastFrameTime>this.frameRate&&(this.frameIndex=(this.frameIndex+1)%this.totalFrames,this.lastFrameTime=t)}update(){this.position.x+=this.velocity.x,this.position.y+=this.velocity.y,this.position.y+this.height+this.velocity.y<this.canvas.height&&(this.velocity.y+=this.gravity)}}class ws{constructor({x:t,y:e,image:s,collisionOffset:o=0},n){this.c=n,this.position={x:t,y:e},this.image=s,this.width=s.width,this.height=s.height,this.collisionOffset=o}draw(){this.c.drawImage(this.image,this.position.x,this.position.y)}getCollisionTop(){return this.position.y+this.collisionOffset}}class ls{constructor(t,e,s,o,n=8,r=80,h=0,c=600){this.c=o,this.position={x:t,y:e},this.spriteSheet=s,this.frameCount=n,this.frameDuration=r,this.pauseFrameIndex=h,this.pauseDuration=c,this.currentFrame=0,this.frameWidth=s.width/n,this.frameHeight=s.height,this.collected=!1,this.lastFrameUpdate=0,this.isPaused=!1}draw(t){if(!this.collected){!this.isPaused&&t-this.lastFrameUpdate>=this.frameDuration&&(this.currentFrame=(this.currentFrame+1)%this.frameCount,this.currentFrame===this.pauseFrameIndex?(this.isPaused=!0,this.lastFrameUpdate=t):this.lastFrameUpdate=t),this.isPaused&&t-this.lastFrameUpdate>=this.pauseDuration&&(this.isPaused=!1,this.lastFrameUpdate=t);const e=this.currentFrame*this.frameWidth;this.c.drawImage(this.spriteSheet,e,0,this.frameWidth,this.frameHeight,this.position.x,this.position.y,this.frameWidth,this.frameHeight)}}checkCollision(t,e){if(this.collected)return;const s=t.position.x,o=t.position.x+t.width,n=t.position.y,r=t.position.y+t.height,h=this.position.x,c=this.position.x+this.frameWidth,g=this.position.y,y=this.position.y+this.frameHeight;o>h&&s<c&&r>g&&n<y&&(this.collected=!0,e())}}class z{constructor({x:t,y:e,image:s,scrollSpeed:o=1,sway:n=!1,scale:r=1,swaySpeed:h=.5,swayAmplitude:c=10,moveSpeed:g=0,totalFrames:y=1,frameRate:d=100,filter:x="blur(2px)"},A){this.c=A,this.initialPosition={x:t,y:e},this.position={x:t,y:e},this.image=s,this.scrollSpeed=o,this.sway=n,this.swaySpeed=h,this.swayAmplitude=c,this.moveSpeed=g,this.time=0,this.scale=r,this.filter=x,this.totalFrames=y,this.frameRate=d,this.frameIndex=0,this.lastFrameTime=0,this.width=this.image.width*r,this.height=this.image.height*r,this.totalFrames>1&&(this.spriteFrameWidth=this.image.width/this.totalFrames*r,this.spriteFrameHeight=this.image.height*r,this.width=this.spriteFrameWidth,this.height=this.spriteFrameHeight)}update(){this.sway&&(this.time+=this.swaySpeed,this.position.y=this.initialPosition.y+Math.sin(this.time)*this.swayAmplitude),this.position.x-=this.moveSpeed}updateAnimation(t){this.totalFrames>1&&t-this.lastFrameTime>this.frameRate&&(this.frameIndex=(this.frameIndex+1)%this.totalFrames,this.lastFrameTime=t)}draw(t=null,e=null){const s=t!==null?t:this.filter;this.totalFrames>1&&e!==null&&this.updateAnimation(e),s&&(this.c.save(),this.c.filter=s),this.totalFrames>1?this.c.drawImage(this.image,this.frameIndex*(this.image.width/this.totalFrames),0,this.image.width/this.totalFrames,this.image.height,this.position.x,this.position.y,this.width,this.height):this.c.drawImage(this.image,this.position.x,this.position.y,this.width,this.height),s&&this.c.restore()}}class Os{constructor({x:t,y:e,image:s,blurAmount:o=0},n){this.c=n,this.position={x:t,y:e},this.image=s,this.blurAmount=o,this.originalWidth=s.width,this.originalHeight=s.height}draw(t=0){const e=this.c;e.save(),this.blurAmount>0&&(e.filter=`blur(${this.blurAmount}px)`);const s=1.2,o=this.originalWidth*s,n=this.originalHeight*s,h=e.canvas.height-n;e.drawImage(this.image,this.position.x-t,h,o,n),e.restore()}}class bs{constructor({x:t,y:e,image:s},o){this.c=o,this.position={x:t,y:e},this.image=s,this.width=s.width,this.height=s.height}draw(){this.c.drawImage(this.image,this.position.x,this.position.y)}checkCollision(t,e){const s=t.position.x,o=t.position.x+t.width,n=t.position.y,r=t.position.y+t.height,h=580,c=this.position.x+h,g=this.position.x+this.width+h,y=this.position.y,d=this.position.y+this.height;o>c&&s<g&&r>y&&n<d&&e()}}class vs{constructor({x:t,y:e,image:s,bounceStrength:o=30,collisionOffset:n=30},r){this.c=r,this.position={x:t,y:e},this.image=s,this.totalFrames=4,this.frameIndex=0,this.frameRate=80,this.lastFrameTime=0,this.isBouncing=!1,this.frameWidth=s.width/this.totalFrames,this.frameHeight=s.height,this.bounceStrength=o,this.collisionOffset=n}draw(){this.c.drawImage(this.image,this.frameIndex*this.frameWidth,0,this.frameWidth,this.frameHeight,this.position.x,this.position.y,this.frameWidth,this.frameHeight)}updateAnimation(t){this.isBouncing?t-this.lastFrameTime>this.frameRate&&(this.frameIndex=(this.frameIndex+1)%this.totalFrames,this.lastFrameTime=t):this.frameIndex=0}checkCollision(t,e){const s=t.position.y+t.height,o=this.position.y+this.collisionOffset,n=this.position.x,r=this.position.x+this.frameWidth,h=t.position.x+t.width,c=t.position.x;s<=o&&s+t.velocity.y>=o&&h>n&&c<r&&(t.velocity.y=-this.bounceStrength,this.isBouncing=!0,e&&e(),setTimeout(()=>{this.isBouncing=!1},320))}}class Ss{constructor({x:t,y:e,width:s,patrolRange:o,speed:n,image:r,totalFrames:h=4,frameRate:c=200},g){this.initialX=t,this.position={x:t,y:e},this.width=s,this.height=0,this.patrolRange=o,this.speed=n,this.context=g,this.image=r,this.direction=1,this.state="alive",this.vy=0,this.toRemove=!1,this.totalFrames=h,this.frameIndex=0,this.frameRate=c,this.lastFrameTime=0,this.image.complete?this.initializeDimensions():this.image.onload=()=>this.initializeDimensions()}initializeDimensions(){this.setHeightBasedOnWidth(),this.spriteFrameWidth=this.image.width/this.totalFrames,this.spriteFrameHeight=this.image.height}setHeightBasedOnWidth(){const t=this.image.naturalWidth/this.totalFrames,e=this.image.naturalHeight/t;this.height=this.width*e,console.log(`Enemy height set to ${this.height} for width ${this.width}`)}updateAnimation(t){this.state==="alive"&&t-this.lastFrameTime>this.frameRate&&(this.frameIndex=(this.frameIndex+1)%this.totalFrames,this.lastFrameTime=t)}update(t){this.state==="alive"?(this.position.x+=this.speed*this.direction,this.position.x>this.initialX+this.patrolRange.right?this.direction=-1:this.position.x<this.initialX+this.patrolRange.left&&(this.direction=1),this.updateAnimation(t)):this.state==="defeated"&&(this.vy+=1,this.position.y+=this.vy,this.position.y>this.context.canvas.height&&(this.toRemove=!0))}draw(t){const e=this.context;if(this.state==="alive"){e.save();const s=this.position.x-t,o=s+this.width/2,n=this.position.y+this.height*.95,r=this.width*1.1,h=this.height*.2,c=e.createRadialGradient(o,n,0,o,n,r/2);c.addColorStop(0,"rgb(12, 48, 9)"),c.addColorStop(1,"rgba(0, 0, 0, 0)"),e.filter="blur(6px)",e.fillStyle=c,e.beginPath(),e.ellipse(o,n,r/2,h/2,0,0,2*Math.PI),e.fill(),e.filter="none",this.direction>0?(e.scale(-1,1),e.drawImage(this.image,this.frameIndex*this.spriteFrameWidth,0,this.spriteFrameWidth,this.spriteFrameHeight,-(s+this.width),this.position.y,this.width,this.height)):e.drawImage(this.image,this.frameIndex*this.spriteFrameWidth,0,this.spriteFrameWidth,this.spriteFrameHeight,s,this.position.y,this.width,this.height),e.restore()}else if(this.state==="defeated"){e.save(),e.filter="blur(2px)";const s=this.position.x-t;e.translate(s+this.width/2,this.position.y+this.height/2),e.rotate(Math.PI),e.drawImage(this.image,0,0,this.spriteFrameWidth,this.spriteFrameHeight,-this.width/2,-this.height/2,this.width,this.height),e.filter="none",e.restore()}}collidesWith(t,e){const s=this.position.x-e;return s<t.position.x+t.width&&s+this.width>t.position.x&&this.position.y<t.position.y+t.height&&this.position.y+this.height>t.position.y}defeat(){this.state="defeated",this.vy=-15}}class Fs{constructor({x:t,y:e,image:s,blurAmount:o=0},n){this.c=n,this.position={x:t,y:e},this.image=s,this.blurAmount=o,this.scaleFactor=1.02}draw(){const t=this.image.width*this.scaleFactor,e=this.image.height*this.scaleFactor,s=(t-this.image.width)/2,o=(e-this.image.height)/2;this.blurAmount&&(this.c.save(),this.c.filter=`blur(${this.blurAmount}px)`),this.c.drawImage(this.image,this.position.x-s,this.position.y-o,t,e),this.blurAmount&&this.c.restore()}}const V=[{playerStart:{x:200,y:100},bgMusic:"/src/assets/backgroundMusic.mp3",foregroundOverlay:{image:"/src/assets/frame.png",blurAmount:5},background:{image:"/src/assets/background_noClouds.jpg",blurAmount:4},levelEnd:23e3,platforms:[{x:0,y:900,image:"/src/assets/ground.png",collisionOffset:60},{x:1400,y:900,image:"/src/assets/ground.png",collisionOffset:60},{x:3e3,y:900,image:"/src/assets/ground.png",collisionOffset:60},{x:5900,y:900,image:"/src/assets/ground.png",collisionOffset:60},{x:7500,y:900,image:"/src/assets/ground.png",collisionOffset:60},{x:12e3,y:900,image:"/src/assets/ground.png",collisionOffset:60},{x:17700,y:900,image:"/src/assets/ground.png",collisionOffset:60},{x:19300,y:900,image:"/src/assets/ground.png",collisionOffset:60},{x:20800,y:900,image:"/src/assets/ground.png",collisionOffset:60},{x:22550,y:900,image:"/src/assets/ground.png",collisionOffset:60},{x:2600,y:550,image:"/src/assets/platform_w512.png",collisionOffset:30},{x:4500,y:650,image:"/src/assets/big_platform.png",collisionOffset:30},{x:4900,y:300,image:"/src/assets/platform_w512.png",collisionOffset:30},{x:9e3,y:600,image:"/src/assets/platform_w512.png",collisionOffset:30},{x:9800,y:400,image:"/src/assets/big_platform.png",collisionOffset:30},{x:10700,y:750,image:"/src/assets/platform_w512.png",collisionOffset:30},{x:11300,y:500,image:"/src/assets/platform_w512.png",collisionOffset:30},{x:13500,y:600,image:"/src/assets/platform_w512.png",collisionOffset:30},{x:14300,y:300,image:"/src/assets/big_platform.png",collisionOffset:30},{x:15300,y:850,image:"/src/assets/platform_w512.png",collisionOffset:30},{x:16e3,y:540,image:"/src/assets/big_platform.png",collisionOffset:30},{x:16700,y:200,image:"/src/assets/platform_w512.png",collisionOffset:30}],enemies:[{x:3500,y:815,width:220,patrolRange:{left:-300,right:300},speed:.3,image:"/src/assets/snail_sprite.png",totalFrames:5,frameRate:200},{x:6450,y:815,width:220,patrolRange:{left:-300,right:300},speed:.3,image:"/src/assets/snail_sprite.png",totalFrames:5,frameRate:200},{x:10870,y:645,width:220,patrolRange:{left:-100,right:100},speed:.3,image:"/src/assets/snail_sprite.png",totalFrames:5,frameRate:200},{x:18180,y:815,width:220,patrolRange:{left:-300,right:300},speed:.3,image:"/src/assets/snail_sprite.png",totalFrames:5,frameRate:200},{x:19832,y:815,width:220,patrolRange:{left:-300,right:300},speed:.3,image:"/src/assets/snail_sprite.png",totalFrames:5,frameRate:200},{x:21324,y:815,width:220,patrolRange:{left:-300,right:300},speed:.3,image:"/src/assets/snail_sprite.png",totalFrames:5,frameRate:200}],mushrooms:[{x:21800,y:790,image:"/src/assets/mushroom_sprite.png",bounceStrength:30}],genericObjects:[{x:3100,y:300,image:"/src/assets/skeleton.png",scrollSpeed:.3},{x:6500,y:300,image:"/src/assets/skeleton.png",scrollSpeed:.3},{x:300,y:50,image:"/src/assets/tree.png",scrollSpeed:.4,scale:1.4},{x:2e3,y:400,image:"/src/assets/tree.png",scrollSpeed:.4},{x:5e3,y:400,image:"/src/assets/tree.png",scrollSpeed:.4},{x:7300,y:400,image:"/src/assets/tree.png",scrollSpeed:.4},{x:2500,y:200,image:"/src/assets/pillar.png",scrollSpeed:.8},{x:10300,y:200,image:"/src/assets/pillar.png",scrollSpeed:.8},{x:23010,y:620,image:"/src/assets/fire_sprite.png",scrollSpeed:1,totalFrames:6,frameRate:140,filter:"none",scale:1.8},{x:23402,y:620,image:"/src/assets/fire_sprite.png",scrollSpeed:1,totalFrames:6,frameRate:130,filter:"none",scale:1.8}],coins:[{x:505,y:565},{x:605,y:565},{x:705,y:565},{x:805,y:565},{x:505,y:665},{x:605,y:665},{x:705,y:665},{x:805,y:665},{x:1243,y:569},{x:1243,y:669},{x:1984,y:652},{x:2084,y:652},{x:2184,y:652},{x:2624,y:260},{x:2724,y:260},{x:2824,y:260},{x:2924,y:260},{x:2624,y:360},{x:2724,y:360},{x:2824,y:360},{x:2924,y:360},{x:3844,y:553},{x:3944,y:553},{x:3844,y:653},{x:3944,y:653},{x:4629,y:365},{x:4729,y:365},{x:4629,y:465},{x:4729,y:465},{x:4981,y:80},{x:5081,y:80},{x:5181,y:80},{x:5981,y:697},{x:5822,y:274},{x:5922,y:274},{x:5822,y:374},{x:5922,y:374},{x:5822,y:474},{x:5922,y:474},{x:6640,y:399},{x:6740,y:399},{x:6640,y:499},{x:6740,y:499},{x:6640,y:599},{x:6740,y:599},{x:7226,y:568},{x:7326,y:568},{x:7226,y:668},{x:7326,y:668},{x:8018,y:442},{x:8118,y:442},{x:8218,y:442},{x:8018,y:542},{x:8118,y:542},{x:8218,y:542},{x:8018,y:642},{x:8118,y:642},{x:8218,y:642},{x:8018,y:742},{x:8118,y:742},{x:8218,y:742},{x:9055,y:400},{x:9155,y:400},{x:9255,y:400},{x:9355,y:400},{x:9845,y:209},{x:9945,y:209},{x:10045,y:209},{x:10145,y:209},{x:10761,y:378},{x:10861,y:378},{x:10961,y:378},{x:11061,y:378},{x:10761,y:478},{x:10861,y:478},{x:10961,y:478},{x:11061,y:478},{x:11358,y:275},{x:11458,y:275},{x:11558,y:275},{x:11658,y:275},{x:12337,y:561},{x:12437,y:561},{x:12537,y:561},{x:12637,y:561},{x:12737,y:561},{x:12837,y:561},{x:12337,y:661},{x:12437,y:661},{x:12537,y:661},{x:12637,y:661},{x:12737,y:661},{x:12837,y:661},{x:13578,y:435},{x:13678,y:435},{x:13778,y:435},{x:14387,y:181},{x:14487,y:181},{x:14587,y:181},{x:14687,y:181},{x:15252,y:329},{x:15352,y:329},{x:15452,y:329},{x:15252,y:429},{x:15352,y:429},{x:15452,y:429},{x:15252,y:529},{x:15352,y:529},{x:15452,y:529},{x:15252,y:629},{x:15352,y:629},{x:15452,y:629},{x:15252,y:729},{x:15352,y:729},{x:15452,y:729},{x:16157,y:201},{x:16257,y:201},{x:16157,y:301},{x:16257,y:301},{x:16157,y:401},{x:16257,y:401},{x:16792,y:40},{x:16892,y:40},{x:16992,y:40},{x:17693,y:256},{x:17793,y:256},{x:17693,y:356},{x:17793,y:356},{x:17693,y:456},{x:17793,y:456},{x:17693,y:556},{x:17793,y:556},{x:17693,y:656},{x:17793,y:656},{x:17693,y:756},{x:17793,y:756},{x:18425,y:633},{x:18525,y:633},{x:18625,y:633},{x:19005,y:542},{x:19105,y:542},{x:19005,y:642},{x:19105,y:642},{x:19005,y:742},{x:19105,y:742},{x:19056,y:585},{x:19056,y:685},{x:19056,y:785},{x:19856,y:407},{x:19956,y:407},{x:19856,y:507},{x:19956,y:507},{x:19856,y:607},{x:19956,y:607},{x:19856,y:707},{x:19956,y:707},{x:20605,y:560},{x:20605,y:660},{x:20605,y:760},{x:21033,y:365},{x:21133,y:365},{x:21233,y:365},{x:21333,y:365},{x:21033,y:465},{x:21133,y:465},{x:21233,y:465},{x:21333,y:465},{x:21033,y:565},{x:21133,y:565},{x:21233,y:565},{x:21333,y:565},{x:21033,y:665},{x:21133,y:665},{x:21233,y:665},{x:21333,y:665},{x:21033,y:765},{x:21133,y:765},{x:21233,y:765},{x:21333,y:765},{x:21906,y:119},{x:21906,y:219},{x:21906,y:319},{x:21906,y:419},{x:22590,y:186},{x:22690,y:186},{x:22590,y:286},{x:22690,y:286},{x:22590,y:386},{x:22690,y:386},{x:22590,y:486},{x:22690,y:486},{x:22590,y:586},{x:22690,y:586},{x:22590,y:686},{x:22690,y:686},{x:22590,y:786},{x:22690,y:786}],finish:{x:22750,y:-10,image:"/src/assets/finish.png"}},{playerStart:{x:200,y:700},bgMusic:"/src/assets/backgroundMusic2.mp3",foregroundOverlay:{image:"/src/assets/frame.png",blurAmount:7},background:{image:"/src/assets/background2.jpg",blurAmount:8},levelEnd:25e3,platforms:[{x:0,y:900,image:"/src/assets/ground.png",collisionOffset:60},{x:1400,y:900,image:"/src/assets/ground.png",collisionOffset:60},{x:3200,y:900,image:"/src/assets/ground.png",collisionOffset:60},{x:5600,y:900,image:"/src/assets/ground.png",collisionOffset:60},{x:8400,y:900,image:"/src/assets/ground.png",collisionOffset:60},{x:12400,y:900,image:"/src/assets/ground.png",collisionOffset:60},{x:16500,y:900,image:"/src/assets/ground.png",collisionOffset:60},{x:18e3,y:900,image:"/src/assets/ground.png",collisionOffset:60},{x:20700,y:900,image:"/src/assets/ground.png",collisionOffset:60},{x:23050,y:900,image:"/src/assets/ground.png",collisionOffset:60},{x:24650,y:900,image:"/src/assets/ground.png",collisionOffset:60},{x:2e3,y:600,image:"/src/assets/platform_w512.png",collisionOffset:30},{x:2600,y:450,image:"/src/assets/big_platform.png",collisionOffset:30},{x:3600,y:700,image:"/src/assets/platform_w512.png",collisionOffset:30},{x:4900,y:400,image:"/src/assets/platform_w512.png",collisionOffset:30},{x:6900,y:400,image:"/src/assets/big_platform.png",collisionOffset:30},{x:7600,y:350,image:"/src/assets/platform_w512.png",collisionOffset:30},{x:9800,y:400,image:"/src/assets/big_platform.png",collisionOffset:30},{x:10500,y:800,image:"/src/assets/platform_w512.png",collisionOffset:30},{x:11500,y:500,image:"/src/assets/big_platform.png",collisionOffset:30},{x:13700,y:450,image:"/src/assets/platform_w512.png",collisionOffset:30},{x:14700,y:750,image:"/src/assets/big_platform.png",collisionOffset:30},{x:15700,y:750,image:"/src/assets/platform_w512.png",collisionOffset:30},{x:19800,y:600,image:"/src/assets/platform_w512.png",collisionOffset:30},{x:22200,y:330,image:"/src/assets/big_platform.png",collisionOffset:30}],enemies:[{x:800,y:820,width:150,patrolRange:{left:-200,right:200},speed:1,image:"/src/assets/enemy_sprite.png",frameRate:200},{x:1900,y:820,width:150,patrolRange:{left:-500,right:400},speed:1,image:"/src/assets/enemy_sprite.png"},{x:3840,y:600,width:150,patrolRange:{left:-200,right:100},speed:1,image:"/src/assets/enemy_sprite.png"},{x:6080,y:820,width:150,patrolRange:{left:-480,right:500},speed:1,image:"/src/assets/enemy_sprite.png"},{x:8950,y:820,width:150,patrolRange:{left:-480,right:500},speed:1,image:"/src/assets/enemy_sprite.png"},{x:10030,y:290,width:150,patrolRange:{left:-150,right:100},speed:1,image:"/src/assets/enemy_sprite.png"},{x:17080,y:820,width:150,patrolRange:{left:-480,right:500},speed:1,image:"/src/assets/enemy_sprite.png"},{x:20020,y:490,width:150,patrolRange:{left:-150,right:100},speed:1,image:"/src/assets/enemy_sprite.png"},{x:21280,y:820,width:150,patrolRange:{left:-480,right:500},speed:1,image:"/src/assets/enemy_sprite.png"},{x:23320,y:820,width:150,patrolRange:{left:-180,right:200},speed:1,image:"/src/assets/enemy_sprite.png"},{x:23820,y:820,width:150,patrolRange:{left:-180,right:200},speed:1,image:"/src/assets/enemy_sprite.png"}],mushrooms:[{x:4200,y:800,image:"/src/assets/mushroom_sprite.png",bounceStrength:30},{x:6500,y:800,image:"/src/assets/mushroom_sprite.png",bounceStrength:30},{x:9400,y:800,image:"/src/assets/mushroom_sprite.png",bounceStrength:30},{x:10700,y:680,image:"/src/assets/mushroom_sprite.png",bounceStrength:30},{x:13400,y:800,image:"/src/assets/mushroom_sprite.png",bounceStrength:30},{x:13900,y:320,image:"/src/assets/mushroom_sprite.png",bounceStrength:30},{x:14850,y:620,image:"/src/assets/mushroom_sprite.png",bounceStrength:30},{x:16e3,y:620,image:"/src/assets/mushroom_sprite.png",bounceStrength:30},{x:18940,y:800,image:"/src/assets/mushroom_sprite.png",bounceStrength:30},{x:21700,y:800,image:"/src/assets/mushroom_sprite.png",bounceStrength:30}],genericObjects:[{x:3e3,y:100,image:"/src/assets/tree.png",scrollSpeed:.4,scale:1.5},{x:5500,y:400,image:"/src/assets/tree.png",scrollSpeed:.4},{x:9500,y:100,image:"/src/assets/tree.png",scrollSpeed:.4,scale:1.3},{x:1e4,y:300,image:"/src/assets/pillar.png",scrollSpeed:.8},{x:14e3,y:200,image:"/src/assets/pillar.png",scrollSpeed:.8},{x:1e3,y:100,image:"/src/assets/skeleton.png",scrollSpeed:.3,scale:1.3}],coins:[{x:459,y:597},{x:581,y:600},{x:718,y:597},{x:1273,y:499},{x:2078,y:806},{x:2185,y:807},{x:2284,y:805},{x:2075,y:276},{x:2179,y:271},{x:2289,y:271},{x:2719,y:115},{x:2799,y:112},{x:2875,y:114},{x:3687,y:334},{x:3808,y:335},{x:3915,y:328},{x:4489,y:358},{x:4562,y:219},{x:4658,y:146},{x:4791,y:131},{x:4869,y:205},{x:4939,y:310},{x:5566,y:150},{x:5689,y:199},{x:5762,y:273},{x:5825,y:380},{x:5863,y:493},{x:5880,y:619},{x:5898,y:733},{x:6607,y:676},{x:7025,y:10},{x:7135,y:7},{x:7251,y:9},{x:7825,y:277},{x:8373,y:315},{x:8458,y:398},{x:8514,y:531},{x:9511,y:665},{x:9564,y:222},{x:9675,y:147},{x:9808,y:213},{x:10023,y:287},{x:10564,y:707},{x:10821,y:521},{x:11049,y:214},{x:11164,y:146},{x:11276,y:122},{x:11407,y:139},{x:11491,y:186},{x:11530,y:262},{x:11566,y:369},{x:12243,y:221},{x:12365,y:283},{x:12459,y:385},{x:12510,y:490},{x:12535,y:616},{x:12542,y:737},{x:12828,y:417},{x:12928,y:413},{x:13051,y:412},{x:13511,y:672},{x:13764,y:357},{x:14013,y:206},{x:14991,y:511},{x:15517,y:87},{x:15612,y:158},{x:15669,y:254},{x:15697,y:359},{x:15715,y:461},{x:15721,y:584},{x:16114,y:515},{x:16728,y:181},{x:16794,y:277},{x:16824,y:394},{x:16841,y:520},{x:16846,y:652},{x:16846,y:786},{x:17803,y:550},{x:18259,y:533},{x:18377,y:529},{x:18488,y:529},{x:19067,y:678},{x:19893,y:253},{x:20013,y:254},{x:20128,y:254},{x:20970,y:519},{x:21077,y:517},{x:21191,y:516},{x:21280,y:516},{x:21388,y:517},{x:21806,y:650},{x:21823,y:471},{x:21849,y:333},{x:21908,y:220},{x:21993,y:154},{x:22097,y:126},{x:22219,y:137},{x:22321,y:204},{x:22408,y:268},{x:22954,y:130},{x:23045,y:186},{x:23093,y:273},{x:23142,y:361},{x:23162,y:457},{x:23187,y:559},{x:23201,y:664},{x:23209,y:785},{x:23702,y:342},{x:23699,y:452},{x:23706,y:567},{x:23702,y:687},{x:23707,y:795},{x:23810,y:335},{x:23808,y:452},{x:23808,y:565},{x:23804,y:685},{x:23801,y:795},{x:23897,y:795},{x:23899,y:686},{x:23892,y:564},{x:23896,y:454},{x:23896,y:335},{x:23988,y:332},{x:23982,y:449},{x:23980,y:564},{x:23979,y:686},{x:23975,y:791},{x:24076,y:326},{x:24074,y:448},{x:24071,y:566},{x:24070,y:675},{x:24064,y:798},{x:24426,y:776},{x:24419,y:680},{x:24419,y:580}],finish:{x:24800,y:-10,image:"/src/assets/finish.png"}},{playerStart:{x:200,y:700},bgMusic:"/src/assets/backgroundMusic3.mp3",foregroundOverlay:{image:"/src/assets/frame.png",blurAmount:7},background:{image:"/src/assets/background3.jpg",blurAmount:8},levelEnd:25e3,platforms:[{x:0,y:900,image:"/src/assets/ground.png",collisionOffset:60},{x:1341,y:900,image:"/src/assets/ground.png",collisionOffset:60},{x:2782,y:900,image:"/src/assets/ground.png",collisionOffset:60},{x:4323,y:900,image:"/src/assets/ground.png",collisionOffset:60},{x:5964,y:900,image:"/src/assets/ground.png",collisionOffset:60},{x:7705,y:900,image:"/src/assets/ground.png",collisionOffset:60},{x:9546,y:900,image:"/src/assets/ground.png",collisionOffset:60},{x:11487,y:900,image:"/src/assets/ground.png",collisionOffset:60},{x:13528,y:900,image:"/src/assets/ground.png",collisionOffset:60},{x:15669,y:900,image:"/src/assets/ground.png",collisionOffset:60},{x:17910,y:900,image:"/src/assets/ground.png",collisionOffset:60},{x:20251,y:900,image:"/src/assets/ground.png",collisionOffset:60},{x:22692,y:900,image:"/src/assets/ground.png",collisionOffset:60},{x:25233,y:900,image:"/src/assets/ground.png",collisionOffset:60},{x:27874,y:900,image:"/src/assets/ground.png",collisionOffset:60},{x:30615,y:900,image:"/src/assets/ground.png",collisionOffset:60},{x:33456,y:900,image:"/src/assets/ground.png",collisionOffset:60},{x:36397,y:900,image:"/src/assets/ground.png",collisionOffset:60},{x:39438,y:900,image:"/src/assets/ground.png",collisionOffset:60},{x:42579,y:900,image:"/src/assets/ground.png",collisionOffset:60},{x:45820,y:900,image:"/src/assets/ground.png",collisionOffset:60},{x:49161,y:900,image:"/src/assets/ground.png",collisionOffset:60},{x:52602,y:900,image:"/src/assets/ground.png",collisionOffset:60},{x:56143,y:900,image:"/src/assets/ground.png",collisionOffset:60},{x:59784,y:900,image:"/src/assets/ground.png",collisionOffset:60},{x:63525,y:900,image:"/src/assets/ground.png",collisionOffset:60},{x:67366,y:900,image:"/src/assets/ground.png",collisionOffset:60},{x:71307,y:900,image:"/src/assets/ground.png",collisionOffset:60},{x:75348,y:900,image:"/src/assets/ground.png",collisionOffset:60},{x:79489,y:900,image:"/src/assets/ground.png",collisionOffset:60}],enemies:[],mushrooms:[],genericObjects:[],coins:[],finish:{x:24800,y:-10,image:"/src/assets/finish.png"}}],m={},Is=["/src/assets/char_sprite.png","/src/assets/platform.png","/src/assets/coin_sprite.png","/src/assets/enemy_sprite.png","/src/assets/cloud.png","/src/assets/heart.png","/src/assets/menu_frame.png","/src/assets/fire_sprite.png","/src/assets/jump.mp3","/src/assets/walk.mp3","/src/assets/land.mp3","/src/assets/die.mp3","/src/assets/win.mp3","/src/assets/bounce.mp3","/src/assets/enemy.mp3","/src/assets/backgroundMusic.mp3","/src/assets/frame.png","/src/assets/background_noClouds.jpg","/src/assets/ground.png","/src/assets/platform_w512.png","/src/assets/big_platform.png","/src/assets/mushroom_sprite.png","/src/assets/skeleton.png","/src/assets/tree.png","/src/assets/pillar.png","/src/assets/finish.png","/src/assets/snail_sprite.png","/src/assets/fire_sprite.png","/src/assets/backgroundMusic2.mp3","/src/assets/background2.jpg","/src/assets/backgroundMusic3.mp3","/src/assets/background3.jpg"];function Es(i){return new Promise(t=>{let e=0;i.forEach(o=>{let n;o.endsWith(".mp3")?(n=new Audio,n.addEventListener("canplaythrough",s,!1),n.addEventListener("error",()=>{console.error(`Error loading asset: ${o}`),s()})):(n=new Image,n.onload=()=>{m[o]=n,s()},n.onerror=()=>{console.error(`Error loading asset: ${o}`),s()}),n.src=o});function s(){e++;const o=e/i.length*100;ks.style.width=o+"%",e===i.length&&t()}})}const f=document.getElementById("gameCanvas"),l=f.getContext("2d"),ts=document.getElementById("debugPanel"),hs=document.getElementById("winOverlay"),cs=document.getElementById("loseOverlay"),_s=document.getElementById("nextLevelBtn"),Rs=document.getElementById("restartBtn"),q=document.getElementById("startOverlay"),As=document.getElementById("startGameBtn"),ks=document.getElementById("loadingBar");let v=null;function Ls(i){v&&(v.pause(),v.currentTime=0),v=new Audio(i),v.loop=!0,v.volume=.6,v.play().catch(t=>{console.log("Autoplay blocked or error:",t)})}const Bs=new Audio("/src/assets/jump.mp3");new Audio("/src/assets/walk.mp3");new Audio("/src/assets/land.mp3");const D=new Audio("/src/assets/die.mp3"),gs=new Audio("/src/assets/coin.mp3");gs.volume=.1;const Ts=new Audio("/src/assets/win.mp3"),Ws=new Audio("/src/assets/bounce.mp3"),Cs=new Audio("/src/assets/enemy.mp3");function u(i){const t=i.cloneNode();t.volume=i.volume,t.play()}let a,w=[],b=[],J=[],F=[],I=[],E=[],_=[],S,W=!1,Q=null,Z=[],p=0,C=0,L="PLAYING",k=0;const Ms=V.length;let M=3;const O={right:{pressed:!1},left:{pressed:!1}};function H(i){const t=new Image;return t.src=i,t}let es=0,$=0,is=0;function Ps({startX:i,endX:t,spacingRange:e=[600,1e3],yRange:s=[50,300],scrollSpeed:o=.1,moveSpeed:n=.2}){const r=H("/src/assets/cloud.png");r.onload=()=>{let h=i;for(;h<=t;){const c=Math.random()*(e[1]-e[0])+e[0],g=Math.random()*(s[1]-s[0])+s[0],y=new z({x:h,y:g,image:r,scrollSpeed:o,sway:!0,swaySpeed:Math.random()*.02+.01,swayAmplitude:Math.random()*3+3,moveSpeed:n},l);Z.push(y),h+=c}}}function Xs(i){if(w=[],b=[],J=[],F=[],I=[],E=[],_=[],C=0,M=3,p=0,Z=[],l.clearRect(0,0,f.width,f.height),i.bgMusic&&Ls(i.bgMusic),hs.style.display="none",cs.style.display="none",Ps({startX:800,endX:i.levelEnd+1e4||23e3,spacingRange:[500,1200],yRange:[10,100],scrollSpeed:.1}),i.platforms.forEach(({x:o,y:n,image:r,collisionOffset:h})=>{const c=m[r];w.push(new ws({x:o,y:n,image:c,collisionOffset:h},l))}),i.mushrooms.forEach(({x:o,y:n,image:r,bounceStrength:h})=>{const c=m[r];F.push(new vs({x:o,y:n,image:c,bounceStrength:h},l))}),i.foregroundOverlay){const o=m[i.foregroundOverlay.image];Q=new Fs({x:0,y:0,image:o,blurAmount:i.foregroundOverlay.blurAmount||0},l)}i.genericObjects.forEach(({x:o,y:n,image:r,scrollSpeed:h=1,scale:c=1,totalFrames:g,frameRate:y,filter:d})=>{const x=m[r];r.includes("fire_sprite.png")?E.push(new z({x:o,y:n,image:x,scrollSpeed:h,scale:c,totalFrames:g,frameRate:y,filter:d},l)):I.push(new z({x:o,y:n,image:x,scrollSpeed:h,scale:c,totalFrames:g,frameRate:y,filter:d},l))});const t=m["/src/assets/coin_sprite.png"];i.coins.forEach(({x:o,y:n})=>{b.push(new ls(o,n,t,l))}),i.enemies.forEach(({x:o,y:n,width:r,height:h,patrolRange:c,speed:g,image:y,totalFrames:d,frameRate:x})=>{const A=m[y];_.push(new Ss({x:o,y:n,width:r,height:h,patrolRange:c,speed:g,image:A,totalFrames:d,frameRate:x},l))});const e=m[i.finish.image];S=new bs({x:i.finish.x,y:i.finish.y,image:e},l);const s=m["/src/assets/char_sprite.png"];if(a=new us(s,l,f),a.position={x:i.playerStart.x,y:i.playerStart.y},a.velocity={x:0,y:0},i.background){const o=m[i.background.image];J=[new Os({x:0,y:0,image:o,blurAmount:i.background.blurAmount||0},l)]}L="PLAYING"}function P(){const i=V[k];Xs(i)}let K=!1;function ys(i){if(!xs||(requestAnimationFrame(ys),i>is+1e3&&(es=$,$=0,is=i),$++,L!=="PLAYING"))return;l.clearRect(0,0,f.width,f.height);const t=p*.02;if(J.forEach(s=>{s.draw(t)}),Z.forEach(s=>{s.update&&s.update(),l.save(),l.filter="blur(2px)",s.draw(),l.restore()}),I.forEach(s=>{s.update&&s.update(),l.save(),s.draw(null,i),l.restore()}),S.draw(),S.checkCollision(a,()=>{L="WIN",hs.style.display="flex",u(Ts)}),E.forEach(s=>{s.update&&s.update(),l.save(),s.draw(null,i),l.restore()}),F.forEach(s=>{s.updateAnimation(i),s.draw(),s.checkCollision(a,()=>{u(Ws)})}),w.forEach(s=>s.draw()),b.forEach(s=>{s.draw(i),s.checkCollision(a,()=>{C+=10,u(gs)})}),_=_.filter(s=>!s.toRemove),_.forEach(s=>{s.update(i),s.draw(p)}),!K){a.draw(),K=!0;return}a.updateAnimation(i),a.update(),a.draw(),Q&&Q.draw(),Ys(),Ns(),R&&ps(Y,j,B,T),l.save(),l.font="16px Arial",l.fillStyle="white",l.fillText(`FPS: ${es}`,40,30),l.restore(),W?a.velocity.x*=.9:O.right.pressed&&a.position.x<400?a.velocity.x=1:O.left.pressed&&a.position.x>350?a.velocity.x=-1:a.velocity.x*=.99,W||(O.right.pressed?(p+=5,w.forEach(s=>{s.position.x-=5}),I.forEach(s=>{s.position.x-=5*s.scrollSpeed}),E.forEach(s=>{s.position.x-=5*s.scrollSpeed}),b.forEach(s=>{s.position.x-=5}),F.forEach(s=>{s.position.x-=5}),S.position.x-=5):O.left.pressed&&(p-=5,w.forEach(s=>{s.position.x+=5}),I.forEach(s=>{s.position.x+=5*s.scrollSpeed}),E.forEach(s=>{s.position.x+=5*s.scrollSpeed}),b.forEach(s=>{s.position.x+=5}),F.forEach(s=>{s.position.x+=5}),S.position.x+=5));let e=!1;w.forEach(s=>{const o=a.getCollisionBox(),n=s.getCollisionTop();o.bottom<=n&&o.bottom+a.velocity.y>=n&&o.right>=s.position.x&&o.left<=s.position.x+s.width&&(a.velocity.y=0,e=!0)}),a.isOnGround=e,!(!a||!K)&&(a.position.y>f.height+300&&os("fall"),_.forEach(s=>{if(s.state==="alive"&&s.collidesWith(a,p)){const o=a.position.y+a.height,n=s.position.y;if(o<=n+30&&a.velocity.y>0){console.log("Enemy stomped!"),s.defeat(),a.velocity.y=-20,u(Cs),C+=10;return}if(a.invincible)return;W=!0,setTimeout(()=>{W=!1},500);const r=a.position.x+p,h=s.position.x;r<h?(a.position.x-=20,a.velocity.x=-15):(a.position.x+=20,a.velocity.x=15),a.velocity.y=-10,os("enemy"),u(D),Hs(2e3)}}))}function Hs(i){a.invincible=!0;const t=setInterval(()=>{a.flicker=!a.flicker},100);setTimeout(()=>{clearInterval(t),a.invincible=!1,a.flicker=!1},i)}function Ys(){const i=`Score: ${C}`,t=f.width-200,e=100;l.shadowColor="rgba(0, 0, 0, 0.8)",l.shadowBlur=3,l.shadowOffsetX=4,l.shadowOffsetY=4,l.font="56px Gorditas",l.fillStyle="yellow",l.textAlign="center",l.fillText(i,t,e),l.shadowColor="rgba(0, 0, 0, 0)",l.shadowBlur=0,l.shadowOffsetX=0,l.shadowOffsetY=0;const s=H("/src/assets/heart.png"),o=70;for(let n=0;n<M;n++){const r=t-120+n*(o+5),h=e+30;l.drawImage(s,r,h,o,o)}}function os(i){if(!a||!a.position){console.error("Player not initialized! Skipping lose life logic.");return}if(M--,M>0)if(i==="fall"){u(D),console.log("Player fell off. Resetting level.");const t=V[k];a.position={x:t.playerStart.x,y:t.playerStart.y},a.velocity={x:0,y:0};const e=p;p=0,w.forEach(s=>s.position.x+=e),I.forEach(s=>s.position.x+=e*s.scrollSpeed),E.forEach(s=>s.position.x+=e*s.scrollSpeed),b.forEach(s=>s.position.x+=e),F.forEach(s=>s.position.x+=e),S.position.x+=e}else i==="enemy"&&console.log("Player hit by an enemy.");else L="LOSE",cs.style.display="flex",document.getElementById("restartBtn").focus(),u(D)}window.addEventListener("keydown",({code:i})=>{if(L==="PLAYING")switch(i){case"KeyW":case"ArrowUp":a.velocity.y===0&&(a.velocity.y=-20,u(Bs));break;case"KeyA":case"ArrowLeft":O.left.pressed=!0,a.facingLeft=!0;break;case"KeyD":case"ArrowRight":O.right.pressed=!0,a.facingLeft=!1;break}});window.addEventListener("keyup",({code:i})=>{switch(i){case"KeyA":case"ArrowLeft":O.left.pressed=!1;break;case"KeyD":case"ArrowRight":O.right.pressed=!1;break}});_s.addEventListener("click",()=>{k++,k<Ms||(k=0),P()});Rs.addEventListener("click",()=>{P()});let U="",X=!1,R=!1,Y=0,j=0,B=0,T=0;const ns=100,fs=8;let ds=null;f.addEventListener("mousedown",i=>{const t=f.getBoundingClientRect();Y=i.clientX-t.left,j=i.clientY-t.top,X=!1,R=!1,ds=setTimeout(()=>{X=!0,R=!0},150)});f.addEventListener("mousemove",i=>{if(R){const t=f.getBoundingClientRect();B=i.clientX-t.left,T=i.clientY-t.top,ps(Y,j,B,T)}});f.addEventListener("mouseup",i=>{if(clearTimeout(ds),R){const t=f.getBoundingClientRect();B=i.clientX-t.left,T=i.clientY-t.top,js(Y,j,B,T)}else if(!X){const t=f.getBoundingClientRect(),e=i.clientX-t.left,s=i.clientY-t.top;ss(e,s)}X=!1,R=!1});function ps(i,t,e,s){l.save(),l.strokeStyle="rgba(0, 0, 255, 0.5)",l.lineWidth=2,l.setLineDash([6]),l.strokeRect(Math.min(i,e),Math.min(t,s),Math.abs(e-i),Math.abs(s-t)),l.restore()}function js(i,t,e,s){const o=Math.min(i,e),n=Math.min(t,s),r=Math.abs(e-i),h=Math.abs(s-t),c=H("/src/assets/coin_sprite.png");c.onload=()=>{const g=c.width/fs,y=c.height,d=o+g/2,x=n+y/2,A=r-g,ms=h-y;for(let G=x;G<=x+ms;G+=ns)for(let N=d;N<=d+A;N+=ns)ss(N,G,c,g,y)}}function ss(i,t,e=null,s=null,o=null){const n=p;if(!e){e=H("/src/assets/coin_sprite.png"),e.onload=()=>{const d=e.width/fs,x=e.height;ss(i,t,e,d,x)};return}const r=i-s/2,h=t-o/2;b.push(new ls(r,h,e,l));const c=Math.round(i+n-s/2),g=Math.round(t-o/2),y=`{ x: ${c}, y: ${g} },
`;U+=y,navigator.clipboard.writeText(U).then(()=>console.log(`Updated clipboard with:
`,U)).catch(d=>console.error("Clipboard update failed:",d)),l.fillStyle="red",l.beginPath(),l.arc(i,t,10,0,Math.PI*2),l.fill()}function Gs(i){const t=i-(a.position.x+p);p+=t,w.forEach(e=>{e.position.x-=t}),I.forEach(e=>{e.position.x-=t*e.scrollSpeed}),E.forEach(e=>{e.position.x-=t*e.scrollSpeed}),b.forEach(e=>{e.position.x-=t}),F.forEach(e=>{e.position.x-=t}),S.position.x-=t,a.position.y=0,console.log(`Teleported player to x: ${i}`)}function Ns(){const i=Math.round(a.position.x+p),t=Math.round(a.position.y);document.getElementById("playerX").textContent=i,document.getElementById("playerY").textContent=t}document.getElementById("jumpBtn").addEventListener("click",()=>{const i=parseInt(document.getElementById("jumpX").value,10);isNaN(i)||Gs(i)});window.addEventListener("keydown",i=>{i.code==="KeyY"&&(ts.style.display=ts.style.display==="none"?"block":"none")});let xs=!1;As.addEventListener("click",async()=>{q.style.display="none",xs=!0,ys()});const as=["Digging up dinosaurs...","Brushing off fossils...","Assembling the T-Rex...","Searching for triceratops footprints...","Feeding the velociraptors...","Calibrating the time machine...","Polishing dinosaur bones...","Adjusting the pterodactyl wings...","Mixing lava for volcano effects...","Sharpening prehistoric tools..."];function rs(){const i=document.querySelector("#loadingOverlay .loading-text"),t=Math.floor(Math.random()*as.length);i.textContent=as[t]}document.addEventListener("DOMContentLoaded",async()=>{q.style.display="none",document.getElementById("loadingOverlay").style.display="flex",rs();let i=setInterval(rs,2e3);await Es(Is),P(),clearInterval(i),document.getElementById("loadingOverlay").style.display="none",q.style.display="flex",f.style.display="block"});
